<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.weixin.reward.dao.UserInfoDao">
        <insert id="saveUserInfo" parameterType="com.weixin.reward.bean.UserInfo">
            insert into userInfo (avatarUrl,city,country,gender,language,nickName,province,openid,session_key)
            values (#{avatarUrl},#{city},#{country},#{gender},#{language},#{nickName},#{province},#{openid},#{session_key})
        </insert>
    <select id="getUserInfoByOpenid" resultType="com.weixin.reward.bean.UserInfo">
        select * from userInfo where openid=#{openid}
    </select>
    <insert id="addUserMessage" parameterType="com.weixin.reward.bean.UserMessage">
        insert into message (openid,nickName,content) values(#{openid},#{nickName},#{content})
    </insert>
    <select id="getUserMessageListByOpenid" resultType="com.weixin.reward.bean.UserMessage">
        select * from message where openid=#{openid}
    </select>
    <update id="updateUserInfo" parameterType="com.weixin.reward.bean.UserInfo">
        update userInfo
        <trim prefix="set" suffixOverrides=",">
            <if test="city!=null">city=#{city},</if>
            <if test="country!=null">country=#{country},</if>
            <if test="gender!=null">gender=#{gender},</if>
            <if test="language!=null">language=#{language},</if>
            <if test="nickName!=null">nickName=#{nickName},</if>
            <if test="province!=null">province=#{province},</if>
            <if test="session_key!=null">session_key=#{session_key},</if>
        </trim>
        where openid=#{openid}
    </update>
</mapper>